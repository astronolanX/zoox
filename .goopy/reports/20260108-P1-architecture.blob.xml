<blob type="decision" scope="project" updated="2026-01-08" v="2">
  <summary>Architecture critique of goopy v0.1.0 - 3 findings, maintainability focus</summary>
  <context>
    Goopy's architecture is intentionally minimal and well-suited for single-user
    session memory. Three patterns create maintainability issues. Overall confidence: 0.88.
  </context>
  <files>
    <file>src/goopy/blob.py</file>
    <file>src/goopy/cli.py</file>
    <file>README.md</file>
  </files>
  <decisions>
    <decision why="Prevent future bugs from list duplication">Centralize KNOWN_SUBDIRS constant derived from BlobType enum</decision>
    <decision why="User expectation alignment">Unify decompose: CLI should call Glob.decompose() not unlink()</decision>
    <decision why="Design documentation">Add Why XML section to README explaining trade-off</decision>
  </decisions>
  <facts>
    <fact>Severity HIGH: Hardcoded subdirs in 4+ locations (confidence 0.95)</fact>
    <fact>Severity MEDIUM: CLI decompose deletes, Glob archives (confidence 0.85)</fact>
    <fact>Severity LOW: XML ~50% larger than JSON (confidence 0.75)</fact>
    <fact>Strength: 850 LOC for full functionality</fact>
    <fact>Strength: Zero dependencies well-maintained</fact>
  </facts>
  <next>
    <step>Create KNOWN_SUBDIRS constant in blob.py</step>
    <step>Refactor surface_relevant, check_migrations to use constant</step>
    <step>Change cmd_decompose to use Glob.decompose()</step>
  </next>
  <related>
    <ref>20260108-P0-security-audit</ref>
    <ref>20260108-P2-scalability</ref>
  </related>
</blob>
